{% extends 'blog/base.html' %}
{% load static %}
{% load blog_tags %}

{% block title %}{{ post.title }}{% endblock %}

{% block head %}
<link href="{% static 'global/prism/dark2/prism.css' %}" rel="stylesheet">
<link href="{% static 'blog/css/custom.css' %}" rel="stylesheet">

<meta property="og:title" content="{{ post.title }}">
<meta property="og:type" content="article">
<meta property="og:url" content="{{ request.build_absolute_uri }}">
<meta property="og:image" content="{% if post.photo %}{{ post.photo.url }}{% endif %}">
<meta property="og:description" content="{{ post.body|truncatechars:150 }}">
<meta property="og:site_name" content="Tech Blog - adrianolczak.pl">
{% endblock %}

{% block content %}
<!--Main-->
<main class="mt-4 mb-5">
  <div class="container">
    <!--Grid row-->
    <div class="row">
      <!--Grid column-->
      <div class=" mb-4">
        <!--Section: Post data-mdb-->
        <section class="border-bottom mb-4">
          <img src="{{ post.photo.url }}" class="img-fluid shadow-2-strong rounded mb-4" alt="" />
          {% for tag in post.tags.all %}
          <a href="{% url 'blog:post_list_by_tag' tag_slug=tag.slug %}" class="badge badge-primary">{{ tag.name }}</a>
          {% endfor %}
          <h1 class="mb-0 h4 pt-3 pb-5 text-center">{{ post.title }}</h1>
          <div class="row align-items-center mb-4">
            <div class="col-lg-6 text-center text-lg-start mb-3 m-lg-0">
              <img src="{{ post.author.profile.photo.url }}" class="rounded me-2" height="35" alt="" loading="lazy" />
              <span> Published <u><time datetime='{{ post.publish|date:"d-m-Y" }}'>{{ post.publish|date:"d.m.Y" }}</time></u> by</span>
              <span class="text-dark">{{ post.author.get_full_name}}</span>
            </div>

            <div class="col-lg-6 text-center text-lg-end d-flex justify-content-end align-items-center">
              {% if post.github_link %}
              <a href="{{ post.github_link }}" target="_blank" class="btn btn-primary px-3 me-1"
                style="background-color: #333;">
                <i class="fab fa-github"></i>
              </a>
              {% endif %}
              <a href="#disqus_thread" class="btn btn-primary px-3 me-1">
                <i class="fas fa-comments"></i>
              </a>
              <p class="text-muted m-0 disqus-comment-count ms-2" style="font-size:13px; vertical-align: middle;" data-disqus-identifier="{{ post.slug }}"></p>
            </div>
          </div>
        </section>
        <!--Section: Post data-->

        <!--Section: Text-->
        <section class="post-content">
          {{ post.body|markdown }}
        </section>
        <!--Section: Text-->

        <!--Section: Share buttons-->
        <section class="text-center border-top border-bottom py-4 mb-4">
          <p><strong>Share with your friends:</strong></p>

          <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank"
            type="button" class="btn btn-primary me-1" style="background-color: #3b5998;">
            <i class="fab fa-facebook-f"></i>
          </a>
          <a href="https://twitter.com/intent/tweet?text={{ post.title }}&url={{ request.build_absolute_uri }}"
            target="_blank" type="button" class="btn btn-primary me-1" style="background-color: #55acee;">
            <i class="fab fa-twitter"></i>
          </a>
          <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}" type="button"
            class="btn btn-primary me-1" style="background-color: #0082ca;">
            <i class="fab fa-linkedin"></i>
          </a>
          <button type="button" class="btn btn-primary me-1" style="background-color: #3e65cf;" data-mdb-toggle="modal"
            data-mdb-target="#staticBackdrop1">
            <i class="fa-solid fa-envelope"></i>
          </button>
          <!-- Modal -->
          <div class="modal fade" id="staticBackdrop1" tabindex="-1" aria-labelledby="exampleModalLabel1"
            aria-hidden="true">
            <div class="modal-dialog d-flex justify-content-center">
              <div class="modal-content w-75">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel1">Share post</h5>
                  <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                  <form action="." method="POST">
                    {% csrf_token %}
                    {% for field in share_form %}
                    <div class="form-outline mb-4">
                      {{ field }}
                      <label class="form-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                    </div>
                    {% endfor %}
                    <!-- Submit button -->
                    <button type="submit" class="btn btn-primary btn-block">Share</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <!-- Modal -->
        </section>
        <!--Section: Share buttons-->

        <!--Section: List of similar posts-->
        <section class="text-center">
          <h4 class="mb-5"><strong>Similar posts</strong></h4>
          <div class="row">
            {% include "blog/includes/post_card.html" with posts=similar_posts col_settings="col-lg-6 mb-4" %}
          </div>
        </section>
        <!--Section: List of similar posts-->

        <!--Section: Comments-->
        <section>
          <div class="container my-5">
            {% include "blog/includes/disqus.html" with post=post domain=domain%}
          </div>
        </section>
        <!--Section: Comments-->
      </div>
      <!--Grid column-->
    </div>
    <!--Grid row-->
  </div>
</main>
<!--Main-->
{% endblock %}

{% block sidebar %}
{% include 'blog/includes/sidebar/sidebar_home.html' %}
{% endblock %}

{% block scripts %}
<script src="{% static 'global/prism/dark2/prism.js' %}"></script>
<script src="{% static 'blog/js/custom.js' %}"></script>
<script id="dsq-count-scr" src="//adrianolczak.disqus.com/count.js" async></script>
{% endblock %}